# ğŸª Grocery Store Management System - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ù‚Ø§Ù„Ø©

Full-stack system: **Spring Boot 3 + Angular + PostgreSQL + JWT**

---

## Database Design (ERD)

```mermaid
erDiagram
    PRODUCT {
        Long id PK
        String name
        String barcode
        String category
        BigDecimal purchasePrice
        BigDecimal sellingPrice
        Integer currentStock
        Integer minStock
        String unit
        Boolean active
        LocalDateTime createdAt
    }
    
    CUSTOMER {
        Long id PK
        String name
        String phone
        BigDecimal totalPurchases
        Integer loyaltyPoints
        LocalDateTime createdAt
    }
    
    SALE {
        Long id PK
        Long customerId FK
        BigDecimal subtotal
        BigDecimal discount
        BigDecimal total
        String paymentMethod
        LocalDateTime createdAt
    }
    
    SALE_ITEM {
        Long id PK
        Long saleId FK
        Long productId FK
        Integer quantity
        BigDecimal unitPrice
        BigDecimal total
    }
    
    SALE ||--o{ SALE_ITEM : "ÙØ§ØªÙˆØ±Ø© ÙÙŠÙ‡Ø§ Ø£ØµÙ†Ø§Ù"
    SALE_ITEM }o--|| PRODUCT : "ÙƒÙ„ ØµÙ†Ù = Ù…Ù†ØªØ¬"
    SALE }o--o| CUSTOMER : "ÙØ§ØªÙˆØ±Ø© Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
```

> [!NOTE]
> **SALE = ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¨ÙŠØ¹** ğŸ§¾ ÙƒÙ„ Ù…Ø±Ø© Ø¹Ù…ÙŠÙ„ Ø¨ÙŠØ´ØªØ±ÙŠØŒ Ø¨ÙŠØªØ¹Ù…Ù„ Ø³Ø¬Ù„ Sale ÙÙŠÙ‡ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„Ø®ØµÙ… ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹.
> **SALE_ITEM = Ø£ØµÙ†Ø§Ù Ø§Ù„ÙØ§ØªÙˆØ±Ø©** â€” ÙƒÙ„ Ù…Ù†ØªØ¬ Ø¬ÙˆÙ‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ù…Ø«Ù„Ø§Ù‹: 2 ÙƒÙŠÙ„Ùˆ Ø³ÙƒØ± + 1 Ø²ÙŠØª).

---

## Project Structure

```
g:\my-app\
â”œâ”€â”€ backend/                          # Spring Boot 3
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/grocery/
â”‚       â”œâ”€â”€ GroceryApplication.java
â”‚       â”œâ”€â”€ config/
â”‚       â”‚   â”œâ”€â”€ SecurityConfig.java    # JWT + CORS
â”‚       â”‚   â””â”€â”€ JwtUtils.java
â”‚       â”œâ”€â”€ entity/
â”‚       â”‚   â”œâ”€â”€ Product.java
â”‚       â”‚   â”œâ”€â”€ Customer.java
â”‚       â”‚   â”œâ”€â”€ Sale.java
â”‚       â”‚   â””â”€â”€ SaleItem.java
â”‚       â”œâ”€â”€ repository/
â”‚       â”‚   â”œâ”€â”€ ProductRepository.java
â”‚       â”‚   â”œâ”€â”€ CustomerRepository.java
â”‚       â”‚   â””â”€â”€ SaleRepository.java
â”‚       â”œâ”€â”€ service/
â”‚       â”‚   â”œâ”€â”€ ProductService.java
â”‚       â”‚   â”œâ”€â”€ CustomerService.java
â”‚       â”‚   â”œâ”€â”€ SaleService.java
â”‚       â”‚   â””â”€â”€ DashboardService.java
â”‚       â”œâ”€â”€ controller/
â”‚       â”‚   â”œâ”€â”€ AuthController.java
â”‚       â”‚   â”œâ”€â”€ ProductController.java
â”‚       â”‚   â”œâ”€â”€ CustomerController.java
â”‚       â”‚   â”œâ”€â”€ SaleController.java
â”‚       â”‚   â””â”€â”€ DashboardController.java
â”‚       â””â”€â”€ dto/
â”‚           â”œâ”€â”€ SaleRequest.java
â”‚           â””â”€â”€ DashboardStats.java
â”‚
â”œâ”€â”€ frontend/                          # Angular 17+
â”‚   â”œâ”€â”€ angular.json
â”‚   â””â”€â”€ src/app/
â”‚       â”œâ”€â”€ core/
â”‚       â”‚   â”œâ”€â”€ services/              # API services
â”‚       â”‚   â”œâ”€â”€ guards/                # Auth guard
â”‚       â”‚   â””â”€â”€ interceptors/          # JWT interceptor
â”‚       â”œâ”€â”€ shared/
â”‚       â”‚   â””â”€â”€ components/            # Reusable UI
â”‚       â””â”€â”€ modules/
â”‚           â”œâ”€â”€ pos/                   # Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹
â”‚           â”œâ”€â”€ inventory/             # Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
â”‚           â”œâ”€â”€ dashboard/             # Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
â”‚           â””â”€â”€ customers/             # Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
```

---

## REST API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/auth/login` | JWT Login |
| GET | `/api/products` | List products (search, filter) |
| POST | `/api/products` | Add product |
| PUT | `/api/products/{id}` | Update product |
| DELETE | `/api/products/{id}` | Delete product |
| GET | `/api/products/low-stock` | Low stock alerts |
| GET | `/api/customers` | List customers |
| POST | `/api/customers` | Add customer |
| PUT | `/api/customers/{id}` | Update customer |
| GET | `/api/customers/{id}/history` | Purchase history |
| POST | `/api/sales` | Create sale (checkout) |
| GET | `/api/sales` | List sales (date range) |
| GET | `/api/dashboard/stats` | Today's KPIs |
| GET | `/api/dashboard/top-products` | Pareto analysis |
| GET | `/api/dashboard/peak-hours` | Peak hours |

---

## Proposed Changes

### Backend (Spring Boot 3)

#### [NEW] `pom.xml` â€” Dependencies: Spring Web, Data JPA, Security, PostgreSQL, Lombok, JJWT
#### [NEW] `application.yml` â€” DB config, JWT secret, server port 8080
#### [NEW] Entities â€” JPA entities with `@Entity`, `@Table`, relationships (`@ManyToOne`, `@OneToMany`)
#### [NEW] Repositories â€” `JpaRepository` interfaces with custom query methods
#### [NEW] Services â€” Business logic: stock deduction on sale, loyalty points calc, dashboard aggregations
#### [NEW] Controllers â€” REST controllers with `@RestController`, validation with `@Valid`
#### [NEW] Security â€” JWT auth filter, `SecurityConfig` with CORS for Angular dev server
#### [NEW] DTOs â€” Request/response objects for sales checkout, dashboard stats

---

### Frontend (Angular 17+)

#### [NEW] POS Module (Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹)
- Product search bar with instant filtering
- Cart with add/remove/quantity
- Discount input (% or fixed)
- Customer linking (optional)
- Checkout â†’ API call â†’ receipt view

#### [NEW] Inventory Module (Ø§Ù„Ù…Ø®Ø²ÙˆÙ†)
- Products table with search/sort/filter
- Add/Edit product dialog
- Low stock alerts banner
- Profit margin display per product

#### [NEW] Dashboard Module (Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…)
- KPI cards: sales today, net profit, transaction count, avg basket
- Charts: 7-day sales bar chart, top 5 products, peak hours
- Slow movers list

#### [NEW] Customers Module (Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡)
- Customers table with search
- Add/Edit customer dialog
- Profile view: total purchases, loyalty points, history
- Loyalty: 1000 EGP = 30 points (auto-calculated)

---

## Build Order

| Step | What | Why |
|------|------|-----|
| 1 | Backend entities + repositories | Foundation |
| 2 | Product CRUD API | Inventory needs it |
| 3 | Angular project + routing + shared UI | Frontend base |
| 4 | Inventory module (Angular) | First visible feature |
| 5 | Sale API + stock deduction | Core business logic |
| 6 | POS module (Angular) | Main daily-use feature |
| 7 | Customer API + loyalty | Retention feature |
| 8 | Customers module (Angular) | Customer management |
| 9 | Dashboard API + aggregations | Analytics |
| 10 | Dashboard module (Angular) | Visual insights |
| 11 | JWT auth | Security |

---

## Verification Plan

### Backend
- Test APIs with browser tool or curl calls
- Verify stock deduction after sale
- Verify loyalty points accumulation

### Frontend
- Open each module in browser and walk through user flows
- Verify RTL Arabic layout
- Capture screenshots for walkthrough
